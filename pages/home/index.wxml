<view class="container">
  <!-- 1. è½®æ’­å›¾åŒºåŸŸ -->
  <view class="swiper-box">
    <swiper indicator-dots="true" autoplay="true" interval="5000" circular="true">
      <block wx:for="{{banners}}" wx:key="_id">
        <swiper-item>
          <image src="{{item.url}}" mode="aspectFill" class="slide-image" />
          <view wx:if="{{isAdmin}}" class="del-btn" catchtap="deleteImage" data-id="{{item._id}}" data-fileid="{{item.url}}">Ã—</view>
        </swiper-item>
      </block>
    </swiper>
    <view wx:if="{{isAdmin}}" class="upload-btn" bindtap="uploadBanner">ğŸ“· æ›´æ¢å°é¢</view>
  </view>

  <!-- 2. èµ›äº‹æŠ¥åæ  -->
  <view class="section">
    <view class="section-title">
      <text>ğŸ”¥ èµ›äº‹æŠ¥å</text>
    </view>
    
    <block wx:for="{{tournaments}}" wx:key="_id">
      <!-- å¢åŠ ç‚¹å‡»äº‹ä»¶ -->
      <view class="tour-card" bindtap="viewTourDetail" data-id="{{item._id}}" data-title="{{item.title}}" data-status="{{item.status}}">
        <view class="tour-info">
          <!-- ... é‡Œé¢çš„å†…å®¹ä¸å˜ ... -->
          
          <!-- æ ‡é¢˜è¡Œ + ç®¡ç†å‘˜æ“ä½œåŒº -->
          <view class="tour-header-row" style="display:flex; justify-content:space-between; align-items:flex-start;">
             <view class="tour-title">
               {{item.title}}
               <!-- æš‚åœçŠ¶æ€æ ‡ç­¾ -->
               <text wx:if="{{item.status == 2}}" style="font-size:10px; background:#999; color:white; padding:2px 5px; border-radius:4px; vertical-align: middle; margin-left: 5px;">å·²æš‚åœ</text>
             </view>
             
             <!-- ç®¡ç†å‘˜ä¸“å±æŒ‰é’®ç»„ -->
             <view wx:if="{{isAdmin}}" style="display:flex; flex-direction:column; align-items:flex-end; gap:5px;">
             <!-- æ–°å¢ï¼šè¿›å…¥æ€»æ§å° -->
            <view style="color:blue; font-size:12px; font-weight:bold;" 
                      catchtap="goToControl" 
                      data-id="{{item._id}}">ğŸ® æ€»æ§å°</view>
                <!-- 1. ç®¡ç†åå• -->
                <view style="color:#07c160; font-size:12px; font-weight:bold;" 
                      catchtap="manageTour" 
                      data-id="{{item._id}}" 
                      data-title="{{item.title}}">âš™ï¸ åå•</view>
                
                <!-- 2. æš‚åœ/å¼€å¯å¼€å…³ -->
                <view style="color:{{item.status==1 ? '#e6a23c' : '#07c160'}}; font-size:12px; font-weight:bold;" 
                      catchtap="toggleStatus" 
                      data-id="{{item._id}}" 
                      data-status="{{item.status}}">
                      {{item.status==1 ? 'â¸ æš‚åœ' : 'â–¶ å¼€å¯'}}
                </view>
             </view>
          </view>
          
          <view class="tour-date">â° æ—¶é—´: {{item.date}}</view>
          <view class="tour-desc">{{item.desc}}</view>
          <view class="tour-count">å·²æŠ¥å: {{item.count || 0}} äºº</view>
        </view>
        
        <!-- æŠ¥åæŒ‰é’®é€»è¾‘ï¼š
             1. è¿˜æ²¡ç™»å½• -> æ˜¾ç¤ºç«‹å³æŠ¥å
             2. å·²æŠ¥å -> å˜ç°æ˜¾ç¤ºå·²æŠ¥å
             3. æœªæŠ¥åä½†æš‚åœäº† -> å˜ç°æ˜¾ç¤ºæš‚åœæŠ¥å
             4. æœªæŠ¥åä¸”å¼€å¯ -> æ˜¾ç¤ºç«‹å³æŠ¥å
        -->
        <button class="btn-sign {{item.isSigned || item.status!=1 ? 'disabled' : ''}}" 
                bindtap="{{(item.isSigned || item.status!=1) ? '' : 'signUp'}}" 
                data-id="{{item._id}}" 
                data-idx="{{index}}">
          {{item.isSigned ? 'å·²æŠ¥å' : (item.status==2 ? 'æš‚åœæŠ¥å' : 'ç«‹å³æŠ¥å')}}
        </button>
      </view>
    </block>

    <view wx:if="{{tournaments.length === 0}}" class="empty">æš‚æ— æ­£åœ¨æŠ¥åçš„èµ›äº‹</view>
  </view>
</view>