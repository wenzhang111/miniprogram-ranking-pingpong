<view class="container">
  <view class="header">
    <view class="title">âš”ï¸ æ™‹çº§å¯¹é˜µå›¾</view>
    <view class="sub">â† å·¦å³æ»‘åŠ¨æŸ¥çœ‹å®Œæ•´èµ›ç¨‹ â†’</view>
  </view>

  <!-- æ ¸å¿ƒï¼šæ¨ªå‘æ»šåŠ¨å®¹å™¨ -->
  <scroll-view scroll-x="true" class="bracket-scroll">
    <view class="bracket-wrapper">
      
      <!-- æ¯ä¸€è½®æ˜¯ä¸€ä¸ªç«–å‘çš„åˆ— -->
      <block wx:for="{{rounds}}" wx:key="index" wx:for-item="roundMatches" wx:for-index="rIdx">
        <view class="round-column">
          <!-- è½®æ¬¡æ ‡é¢˜ -->
          <view class="round-title">{{roundMatches[0].round}}</view>
          
          <!-- è¿™ä¸€è½®çš„æ‰€æœ‰æ¯”èµ› (ä½¿ç”¨ Flex å‡åŒ€åˆ†å¸ƒ) -->
          <view class="match-list">
            <block wx:for="{{roundMatches}}" wx:key="_id" wx:for-index="mIdx">
              
              <!-- å•ä¸ªå¯¹é˜µå¡ç‰‡ -->
              <view class="match-card-wrapper">
                <view class="match-item {{item.status==1?'finished':''}}" 
                      bindtap="adminRecord" 
                      data-idx="{{mIdx}}" 
                      data-roundidx="{{rIdx}}">
                  
                  <!-- é€‰æ‰‹A -->
                  <view class="player-row {{item.winner==item.player1?'win':''}}">
                    <text class="p-name">{{item.player1_name}}</text>
                    <text wx:if="{{item.winner==item.player1}}">ğŸ‘‘</text>
                  </view>
                  
                  <!-- é€‰æ‰‹B -->
                  <view class="player-row {{item.winner==item.player2?'win':''}}">
                    <text class="p-name">{{item.player2_name}}</text>
                    <text wx:if="{{item.winner==item.player2}}">ğŸ‘‘</text>
                  </view>

                  <!-- çŠ¶æ€æ ‡è®° -->
                  <view class="score-tag" wx:if="{{item.status==1}}">å®Œ</view>
                </view>
                
                <!-- è¿æ¥çº¿ (è£…é¥°ç”¨) -->
                <view class="connector" wx:if="{{rIdx < rounds.length - 1}}"></view>
              </view>

            </block>
          </view>
        </view>
      </block>

      <!-- å ä½ï¼Œé˜²æ­¢æœ€å³è¾¹è¢«æŒ¡ä½ -->
      <view style="width: 50px; flex-shrink: 0;"></view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="footer-btn" wx:if="{{isAdmin}}">
    <button class="btn-next" bindtap="generateNextRound">âš¡ ç”Ÿæˆä¸‹ä¸€è½®</button>
  </view>
</view>